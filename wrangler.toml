name = "notion-sprint-worker"
main = "src/index.ts"
compatibility_date = "2025-01-01"

# Cron Triggers (UTC).
# 00:00 UTC = 09:00 JST (担当者通知)
# 00:10-00:50 UTC = 09:10-09:50 JST (10分毎: 担当者リマインド)
# 01:00 UTC = 10:00 JST (PMレポート)
# 02-10 UTC = 11:00-19:00 JST (毎時: PM未返信リマインド)
triggers = { crons = ["0 0 * * *", "10,20,30,40,50 0 * * *", "0 1 * * *", "0 2-10 * * *", "15 * * * *", "0 15 * * *"] }

[observability]
enabled = true

# Replace with your KV namespace IDs.
[[kv_namespaces]]
binding = "NOTIFY_CACHE"
id = "0d755a2c50404149ad9c03c4d7d2fad5"
preview_id = "0d755a2c50404149ad9c03c4d7d2fad5"

[vars]
OPENAI_MODEL = "gpt-4.1-mini"
NOTIFY_PROPERTIES = "[\"確定 見積SP\",\"確定 実績SP\",\"確定 想定\"]"

# --- dev 環境用の上書き例（任意） ---
[env.dev]
name = "notion-sprint-worker-dev"
triggers = { crons = ["0 23 * * *"] } # 08:00 JST 相当
[[env.dev.kv_namespaces]]
binding = "NOTIFY_CACHE"
id = "0d755a2c50404149ad9c03c4d7d2fad5"
preview_id = "0d755a2c50404149ad9c03c4d7d2fad5"

[env.dev.vars]
OPENAI_MODEL = "gpt-4.1-mini"
NOTIFY_PROPERTIES = "[\"確定 見積SP\",\"確定 実績SP\",\"確定 想定\"]"
